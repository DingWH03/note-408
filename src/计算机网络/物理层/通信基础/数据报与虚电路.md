# 数据报与虚电路

在计算机网络体系结构中，物理层负责在设备间透明传输原始比特流，数据链路层通过帧封装与差错控制实现相邻节点的可靠传输。而网络层作为通信子网的核心，向上层提供两种本质不同的分组交换服务模式：

1. 面向连接的虚电路服务（Virtual Circuit）和无连接的数据报服务（Datagram）。
2. 这两种服务的核心差异在于通信路径的建立方式与分组处理逻辑。

> 注：虽然传输层TCP提供类似虚电路的可靠服务，UDP提供类似数据报的服务，但二者本质是**终端系统实现的端到端功能**，而非网络层的基础服务。在TCP/IP体系结构中，网络层（IP层）仅提供无连接的数据报服务，这是互联网架构的根基设计，传输层中通过TCP与UDP协议实现了两种服务的抽象。
>
> 在OSI模型中，网络层必须同时支持数据报和虚电路两种方式，但是TCP/IP模型为了减轻网络设备负担，从而在网络层仅支持数据报方式，将虚电路的实现交由高层实现。

## 1. 虚电路

在虚电路方式中，当两台计算机进行通信时，应当先建立网络层的连接，也就是建立一条逻辑上的虚电路(Virtual Circuit, VC)，连接一旦建立，就固定了虚电路对应的物理路径。与电路交换类似，整个通信过程分为三个阶段：虚电路建立、数据传输与虚电路释放。

每次建立虚电路时，将一个未用过的**虚电路号**(VCID)分配给该虚电路，以区别本系统中的其他虚电路，然后双方就沿着已建立的虚电路传送分组。

## 2. 数据报
